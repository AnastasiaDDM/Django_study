{% extends 'basic/pattern.html' %}
{% load static %}
{% load software_tags %}
{% load common_tags %}
<title>{% block page_title %}{{software.name}}{% endblock %}

  {% block link_extend %}
  <link rel="stylesheet" href="{% static '/css/lightbox.min.css' %}">
  {% endblock %}



 {% block content %}

 {% block content_title %}
 <h1>{{software.name}}</h1>
{% endblock %}
{% block breadcrumb %}
<ul class="breadcrumb">
{% breadcrumb_url 'Главная' 'software:catalog' %}
{% breadcrumb_url 'Каталог' 'software:catalog' %}
{% breadcrumb_url 'Настольное приложенте -- НЕ СДЕЛАНО' 'software:catalog' %}
{% breadcrumb_url software.name %}
</ul>
{% endblock %}

 <section>
  <div class="flex_column  pos_left padding_top_2em padding_bottom_2em" >
    <div class="flex_row flex_space-between width_100"> 
      <!--Это контейнер фоток ПО и начала его описания, характеристик-->
      <div class="flex_column w_50_sm pos_center_sm"> 
        <!--фото ПО и теги(которые потом в мобилке будут убираться)-->
        <div class="flex_row flex_wrap">
        {% if main_photo %}
        <a class="example-image-link" href="{{main_photo.photo.url}}" data-lightbox="example-set" 
        data-title="{{main_photo.name}}"><img class="example-image img_width padding_bottom_2em" src="{{main_photo.photo.url}}" alt="{{main_photo.name}}"/></a>
        {% endif %} 
        {% if software_img %}
        {% for s in software_img %}
        <div class = "img_margin">
            <a class="example-image-link" href="{{s.photo.url}}" data-lightbox="example-set" 
            data-title="{{s.name}}"><img class="example-image max_width_10em_img" src="{{s.photo.url}}" alt="{{s.name}}"/></a>
        </div>
        {% endfor %}
        {% endif %} 
        {% if not main_photo and not software_img %}
            Фотографий нет
        {% endif %} 
        </div>
            {% if software_tag %}
            <fieldset class="fieldset_tags software_tag_first">
                <legend class="pos_center">Теги
                </legend>
                <form>
                    <div class = "fieldset_tags_word">
                        <span>
                        {% for tag in software_tag %}
                            <a href="catalog.html">#{{tag.name}}</a>
                        {% endfor %}
                        </span>
                    </div>        
                </form>
            </fieldset>
            {% endif %} 
      </div>
      <div class="flex_column w_50_sm padding_left_4em_sm padding_top_2em_sm"> 
        <!--Это контейнер цены, кнопок и описания-->
        <div class="flex_column"> 
          <!--Это контейнер цены и кнопок-->
            {% if software.is_free is False %}
            <div class = "page_software_price">
            {{software.price|floatformat|add:'&#8381'|default:""}}  
            </div>
            {% endif %}
          <div class="flex_column padding_bottom_2em w_70_md"> 
            {% if software.modification %}
            <!--Это контейнер кнопок-->
            <div>
                <button href="buy.html" class="button_pay width_100 margin_top-bootom_1em">
                {% if software.price <= 0 or software.is_free %}
                Скачать бесплатно
                {% else %}
                Приобрести
                {% endif %}  
                </button>
            </div>
            <div class="flex_row  flex_space-between">
                <button class="button_pay button_pay_width_full">Заказать доработку
                </button>
                <div>
                {% if request.user.is_authenticated %}
                {% with favourite=software|is_favourite:request.user %}
                    {% if favourite %}
                    <i class="fa fa-heart button_like_true" aria-hidden="true"></i>
                    {% else %}
                    <i class="fa fa-heart button_like" aria-hidden="true"></i>
                    {% endif %}
                {% endwith %}
                {% endif %}  
                </div>
            </div>
            {% else %}
            <!--Это контейнер кнопок-->
            <div class="flex_row  flex_space-between">
                <button class="button_pay button_pay_width_full">Скачать бесплатно
                </button>
                <div>
                    <div data-target="favourite" data-url="/softwares/favourite/"  data-id="{{software.id}}">
                    {% if request.user.is_authenticated %}
                    {% with favourite=software|is_favourite:request.user %}
                        {% if favourite %}
                        <i class="fa fa-heart button_like_true" aria-hidden="true"></i>
                        {% else %}
                        <i class="fa fa-heart button_like" aria-hidden="true"></i>
                        {% endif %}
                    {% endwith %}
                    {% endif %}  
                    </div>
                </div>
            </div>
            {% endif %} 
          </div>
        </div>
        <div >
          <div class="">
            <ul class = "pos_left software_description_list"style = "list-style: none">
              <li class="software_description_marker">Вид: 
                <span>{{classif.type|default:"Не задано"}}
                </span>
              </li>
              <li class="software_description_marker">Область: 
                <span>{{classif.area|default:"Не задано"}}
                </span>
              </li>
              <li class="software_description_marker"> Размер приложения: {{software.size|filesizeformat|default:"Не задано"}}
              </li>
              <li class="software_description_marker">Тип использования: 
                <span>{{classif.type_of_use|default:"Не задано"}}
                </span>
              </li>
              <li class="software_description_marker">Ограничение доступа: 
                <span>{{classif.access|default:"Не задано"}}
                </span>
              </li>
              <li class="software_description_marker">Дополнительные установки: 
                <span>{{classif.extra_install|default:"Не задано"}}
                </span>
              </li>
              <li class="software_description_marker">Установка приложение: 
                <span>{{classif.install|default:"Не задано"}}
                </span>
              </li>
            </ul>
          </div>
          <div class="margin_top-bootom_1em page_software_description">
            <div>{{list_descr.0}}
            </div>
            <div style="display: none;" id="description_text" class="all_text">
                {{list_descr.1|linebreaks}}
            </div>  
          </div>
          <div class="margin_top-bootom_1em pos_left bt_read_pos_center">
            <a class="button_reset text_roll" data-target="description_text">Читать полностью
            </a>
          </div> 
        </div>
      </div>
    </div>
  </div>
  <div> 
    <!--Это контейнер кнопок, которые находятся в контенте-->
    <div class="flex_row w_50_sm pos_center padding_top_2em padding_bottom_2em">
      <button href="buy.html" class="button_pay button_pay_width_full ">
        {% if software.price <= 0 or software.is_free %}
        Скачать бесплатно
        {% else %}
        {{software.price|floatformat |default:""}}  &#8381 Приобрести
        {% endif %}
      </button>
      <div >
        <i class="fa fa-heart button_like width_30" aria-hidden="true">
        </i>
      </div>
    </div>
  </div>
  <div class="margin_top_3em">    
    <!--Это контейнер похожих ПО-->
    <div class="pos_center">
      <h2>Похожие программные продукты
      </h2>
    </div>
    <div>
      {% if software_tag %}
      <fieldset class="fieldset_tags  w_50_sm_auto pos_center software_tag_second">
        <legend class="pos_center">Теги
        </legend>
        <div class = "fieldset_tags_word">
            <span>
            {% for tag in software_tag %}
                <a href="catalog.html">#{{tag.name}}</a>
            {% endfor %}
            </span>
        </div>        
      </fieldset>
      {% endif %} 
      <div class="margin_top_3em"> 
        {{similar_block}}
      </div>
    </div>
    <div class="margin_top_3em">
      <div class="pos_center padding_top_2em">
        <h2>Обсуждения данного продукта
        </h2>
      </div>
      {{discussion_comment_block}}
    </div>
    </section>

    <div id="pattern_form_answer" style="display: none;">
      <div class="copy_form_answer" style="display: none;">
        <div class=" flex_column pos_center margin_top_1em width_100">     
          <!-- Форма комментария -->
          <h3>Ответ
          </h3>
          <fieldset class=" fieldset_border_primary padding_2em_xs">
            <form>
              <div class="pos_center">
                <div class="flex_row flex_space-between">
                  <div class="input_style w_45_sm">
                    <input type="text" id="name" autocomplete="off">
                    <label for="name">Ваше имя
                    </label>
                  </div>
                  <div class="input_style w_45_sm">
                    <input type="text" id="phone" required>
                    <label for="phone">Номер телефона/ эл.почта
                    </label>
                  </div>
                </div>
                <div>
                  <div class="textarea_style margin_top_3em textarea_height_small">
                    <textarea type="textarea"></textarea>
                    <label id = "label" class = "textarea_style_label">Ваш комментарий
                    </label>
                  </div>
                </div>
              </div>
    
              <div class="flex_row flex_space-between margin_top_3em">
                <div class="btn_cancel">
                  <a class="button_reset">Отменить
                  </a>
                </div>
                <div class="">
                  <a href="#" class="button_reset">Оставить комментарий
                  </a>
                </div>
              </div>
            </form>
          </fieldset>
        </div>
      </div>
    </div>
    {% endblock %}	


    {% block js_extend %}
    <script src="{% static '/js/slick.min.js' %}"></script>
    <script src="{% static '/js/lightbox.min.js' %}"></script>
    <script>
        jQuery(document).ready(function () {
          comments_form_answer();
          input_filled('input');
          input_filled('textarea');
          carousel_soft('same_software');
          read_more_text_roll();
          favourite();
        })          
    </script>
    {% endblock %}
